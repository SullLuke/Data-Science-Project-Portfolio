<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>c25d66f2cd9f484284120a184754c8e2</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="loan-default-prediction" class="cell markdown"
id="1_iHEvciuTB9">
<h1><strong>Loan Default Prediction</strong></h1>
</section>
<section id="problem-definition" class="cell markdown"
id="ZKyzwpUiuTB2">
<h2><strong>Problem Definition</strong></h2>
<h3 id="the-context"><strong>The Context:</strong></h3>
<ul>
<li>Why is this problem important to solve?</li>
</ul>
<h3 id="the-objective"><strong>The objective:</strong></h3>
<ul>
<li>What is the intended goal?</li>
</ul>
<h3 id="the-key-questions"><strong>The key questions:</strong></h3>
<ul>
<li>What are the key questions that need to be answered?</li>
</ul>
<h3 id="the-problem-formulation"><strong>The problem
formulation</strong>:</h3>
<ul>
<li>What is it that we are trying to solve using data science?</li>
</ul>
</section>
<section id="data-description" class="cell markdown" id="qEHRGpcdo-KO">
<h2><strong>Data Description:</strong></h2>
<p>The Home Equity dataset (HMEQ) contains baseline and loan performance
information for 5,960 recent home equity loans. The target (BAD) is a
binary variable that indicates whether an applicant has ultimately
defaulted or has been severely delinquent. This adverse outcome occurred
in 1,189 cases (20 percent). 12 input variables were registered for each
applicant.</p>
<ul>
<li><p><strong>BAD:</strong> 1 = Client defaulted on loan, 0 = loan
repaid</p></li>
<li><p><strong>LOAN:</strong> Amount of loan approved.</p></li>
<li><p><strong>MORTDUE:</strong> Amount due on the existing
mortgage.</p></li>
<li><p><strong>VALUE:</strong> Current value of the property.</p></li>
<li><p><strong>REASON:</strong> Reason for the loan request. (HomeImp =
home improvement, DebtCon= debt consolidation which means taking out a
new loan to pay off other liabilities and consumer debts)</p></li>
<li><p><strong>JOB:</strong> The type of job that loan applicant has
such as manager, self, etc.</p></li>
<li><p><strong>YOJ:</strong> Years at present job.</p></li>
<li><p><strong>DEROG:</strong> Number of major derogatory reports (which
indicates a serious delinquency or late payments).</p></li>
<li><p><strong>DELINQ:</strong> Number of delinquent credit lines (a
line of credit becomes delinquent when a borrower does not make the
minimum required payments 30 to 60 days past the day on which the
payments were due).</p></li>
<li><p><strong>CLAGE:</strong> Age of the oldest credit line in
months.</p></li>
<li><p><strong>NINQ:</strong> Number of recent credit
inquiries.</p></li>
<li><p><strong>CLNO:</strong> Number of existing credit lines.</p></li>
<li><p><strong>DEBTINC:</strong> Debt-to-income ratio (all your monthly
debt payments divided by your gross monthly income. This number is one
way lenders measure your ability to manage the monthly payments to repay
the money you plan to borrow.</p></li>
</ul>
</section>
<section id="import-the-necessary-libraries-and-data"
class="cell markdown" id="DcZcGaZruTB-">
<h2><strong>Import the necessary libraries and Data</strong></h2>
</section>
<div class="cell code" data-execution_count="55"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:71}"
data-executionInfo="{&quot;elapsed&quot;:21549,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231418,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="pvj9AGJtuTB_" data-outputId="f2bc50fc-8175-4a39-f0f8-bb7cb9a07c94">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> files</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>uploaded <span class="op">=</span> files.upload()</span></code></pre></div>
<div class="output display_data">

     <input type="file" id="files-7317d8dc-c9a5-4365-9753-fc87b3e42355" name="files[]" multiple disabled
        style="border:none" />
     <output id="result-7317d8dc-c9a5-4365-9753-fc87b3e42355">
      Upload widget is only available when the cell has been executed in the
      current browser session. Please rerun this cell to enable.
      </output>
      <script>// Copyright 2017 Google LLC
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//      http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * @fileoverview Helpers for google.colab Python module.
 */
(function(scope) {
function span(text, styleAttributes = {}) {
  const element = document.createElement('span');
  element.textContent = text;
  for (const key of Object.keys(styleAttributes)) {
    element.style[key] = styleAttributes[key];
  }
  return element;
}

// Max number of bytes which will be uploaded at a time.
const MAX_PAYLOAD_SIZE = 100 * 1024;

function _uploadFiles(inputId, outputId) {
  const steps = uploadFilesStep(inputId, outputId);
  const outputElement = document.getElementById(outputId);
  // Cache steps on the outputElement to make it available for the next call
  // to uploadFilesContinue from Python.
  outputElement.steps = steps;

  return _uploadFilesContinue(outputId);
}

// This is roughly an async generator (not supported in the browser yet),
// where there are multiple asynchronous steps and the Python side is going
// to poll for completion of each step.
// This uses a Promise to block the python side on completion of each step,
// then passes the result of the previous step as the input to the next step.
function _uploadFilesContinue(outputId) {
  const outputElement = document.getElementById(outputId);
  const steps = outputElement.steps;

  const next = steps.next(outputElement.lastPromiseValue);
  return Promise.resolve(next.value.promise).then((value) => {
    // Cache the last promise value to make it available to the next
    // step of the generator.
    outputElement.lastPromiseValue = value;
    return next.value.response;
  });
}

/**
 * Generator function which is called between each async step of the upload
 * process.
 * @param {string} inputId Element ID of the input file picker element.
 * @param {string} outputId Element ID of the output display.
 * @return {!Iterable<!Object>} Iterable of next steps.
 */
function* uploadFilesStep(inputId, outputId) {
  const inputElement = document.getElementById(inputId);
  inputElement.disabled = false;

  const outputElement = document.getElementById(outputId);
  outputElement.innerHTML = '';

  const pickedPromise = new Promise((resolve) => {
    inputElement.addEventListener('change', (e) => {
      resolve(e.target.files);
    });
  });

  const cancel = document.createElement('button');
  inputElement.parentElement.appendChild(cancel);
  cancel.textContent = 'Cancel upload';
  const cancelPromise = new Promise((resolve) => {
    cancel.onclick = () => {
      resolve(null);
    };
  });

  // Wait for the user to pick the files.
  const files = yield {
    promise: Promise.race([pickedPromise, cancelPromise]),
    response: {
      action: 'starting',
    }
  };

  cancel.remove();

  // Disable the input element since further picks are not allowed.
  inputElement.disabled = true;

  if (!files) {
    return {
      response: {
        action: 'complete',
      }
    };
  }

  for (const file of files) {
    const li = document.createElement('li');
    li.append(span(file.name, {fontWeight: 'bold'}));
    li.append(span(
        `(${file.type || 'n/a'}) - ${file.size} bytes, ` +
        `last modified: ${
            file.lastModifiedDate ? file.lastModifiedDate.toLocaleDateString() :
                                    'n/a'} - `));
    const percent = span('0% done');
    li.appendChild(percent);

    outputElement.appendChild(li);

    const fileDataPromise = new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = (e) => {
        resolve(e.target.result);
      };
      reader.readAsArrayBuffer(file);
    });
    // Wait for the data to be ready.
    let fileData = yield {
      promise: fileDataPromise,
      response: {
        action: 'continue',
      }
    };

    // Use a chunked sending to avoid message size limits. See b/62115660.
    let position = 0;
    do {
      const length = Math.min(fileData.byteLength - position, MAX_PAYLOAD_SIZE);
      const chunk = new Uint8Array(fileData, position, length);
      position += length;

      const base64 = btoa(String.fromCharCode.apply(null, chunk));
      yield {
        response: {
          action: 'append',
          file: file.name,
          data: base64,
        },
      };

      let percentDone = fileData.byteLength === 0 ?
          100 :
          Math.round((position / fileData.byteLength) * 100);
      percent.textContent = `${percentDone}% done`;

    } while (position < fileData.byteLength);
  }

  // All done.
  yield {
    response: {
      action: 'complete',
    }
  };
}

scope.google = scope.google || {};
scope.google.colab = scope.google.colab || {};
scope.google.colab._files = {
  _uploadFiles,
  _uploadFilesContinue,
};
})(self);
</script> 
</div>
<div class="output stream stdout">
<pre><code>Saving hmeq.csv to hmeq (1).csv
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="56"
data-executionInfo="{&quot;elapsed&quot;:15,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231418,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="Sb62uZ1m_1g7">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, classification_report,accuracy_score,precision_score,recall_score,f1_score</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> tree</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> BaggingClassifier</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> SimpleImputer</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> plot_tree</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="57"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231418,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="he3GZk2S8A9W">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;hmeq.csv&#39;</span>)</span></code></pre></div>
</div>
<section id="data-overview" class="cell markdown" id="T9ykJzCRuTCD">
<h2><strong>Data Overview</strong></h2>
</section>
<div class="cell markdown" id="DLgLExFVBZtg">
<ul>
<li>Reading the dataset</li>
<li>Understanding the shape of the dataset</li>
<li>Checking the data types</li>
<li>Checking for missing values</li>
<li>Checking for duplicated values</li>
</ul>
</div>
<div class="cell code" data-execution_count="58"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="za7znZ1cBZtg" data-outputId="ca0f009e-105c-4ba8-d98c-0a3d742427e0">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data.head(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="58">

  <div id="df-12afb49f-72f2-4e01-a696-5d4ae795860b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BAD</th>
      <th>LOAN</th>
      <th>MORTDUE</th>
      <th>VALUE</th>
      <th>REASON</th>
      <th>JOB</th>
      <th>YOJ</th>
      <th>DEROG</th>
      <th>DELINQ</th>
      <th>CLAGE</th>
      <th>NINQ</th>
      <th>CLNO</th>
      <th>DEBTINC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1100</td>
      <td>25860.0</td>
      <td>39025.0</td>
      <td>HomeImp</td>
      <td>Other</td>
      <td>10.5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>94.366667</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1300</td>
      <td>70053.0</td>
      <td>68400.0</td>
      <td>HomeImp</td>
      <td>Other</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>121.833333</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1500</td>
      <td>13500.0</td>
      <td>16700.0</td>
      <td>HomeImp</td>
      <td>Other</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>149.466667</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1500</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1700</td>
      <td>97800.0</td>
      <td>112000.0</td>
      <td>HomeImp</td>
      <td>Office</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>93.333333</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-12afb49f-72f2-4e01-a696-5d4ae795860b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-12afb49f-72f2-4e01-a696-5d4ae795860b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-12afb49f-72f2-4e01-a696-5d4ae795860b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-09cd48fc-34f0-4548-9ea4-feb3900fe4dd">
  <button class="colab-df-quickchart" onclick="quickchart('df-09cd48fc-34f0-4548-9ea4-feb3900fe4dd')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-09cd48fc-34f0-4548-9ea4-feb3900fe4dd button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="59"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:301}"
data-executionInfo="{&quot;elapsed&quot;:13,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="LaeT7tUh-YrT" data-outputId="d44010d5-e787-4b54-e075-b65ff4b786f4">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="59">

  <div id="df-d96321fc-c96b-4520-a4cc-6391cb3f39ce" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>BAD</th>
      <th>LOAN</th>
      <th>MORTDUE</th>
      <th>VALUE</th>
      <th>YOJ</th>
      <th>DEROG</th>
      <th>DELINQ</th>
      <th>CLAGE</th>
      <th>NINQ</th>
      <th>CLNO</th>
      <th>DEBTINC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5960.000000</td>
      <td>5960.000000</td>
      <td>5442.000000</td>
      <td>5848.000000</td>
      <td>5445.000000</td>
      <td>5252.000000</td>
      <td>5380.000000</td>
      <td>5652.000000</td>
      <td>5450.000000</td>
      <td>5738.000000</td>
      <td>4693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.199497</td>
      <td>18607.969799</td>
      <td>73760.817200</td>
      <td>101776.048741</td>
      <td>8.922268</td>
      <td>0.254570</td>
      <td>0.449442</td>
      <td>179.766275</td>
      <td>1.186055</td>
      <td>21.296096</td>
      <td>33.779915</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.399656</td>
      <td>11207.480417</td>
      <td>44457.609458</td>
      <td>57385.775334</td>
      <td>7.573982</td>
      <td>0.846047</td>
      <td>1.127266</td>
      <td>85.810092</td>
      <td>1.728675</td>
      <td>10.138933</td>
      <td>8.601746</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>1100.000000</td>
      <td>2063.000000</td>
      <td>8000.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.524499</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>11100.000000</td>
      <td>46276.000000</td>
      <td>66075.500000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>115.116702</td>
      <td>0.000000</td>
      <td>15.000000</td>
      <td>29.140031</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>16300.000000</td>
      <td>65019.000000</td>
      <td>89235.500000</td>
      <td>7.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>173.466667</td>
      <td>1.000000</td>
      <td>20.000000</td>
      <td>34.818262</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.000000</td>
      <td>23300.000000</td>
      <td>91488.000000</td>
      <td>119824.250000</td>
      <td>13.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>231.562278</td>
      <td>2.000000</td>
      <td>26.000000</td>
      <td>39.003141</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>89900.000000</td>
      <td>399550.000000</td>
      <td>855909.000000</td>
      <td>41.000000</td>
      <td>10.000000</td>
      <td>15.000000</td>
      <td>1168.233561</td>
      <td>17.000000</td>
      <td>71.000000</td>
      <td>203.312149</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d96321fc-c96b-4520-a4cc-6391cb3f39ce')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d96321fc-c96b-4520-a4cc-6391cb3f39ce button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d96321fc-c96b-4520-a4cc-6391cb3f39ce');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-007d05ea-fd5c-485d-95f5-63b6d5717990">
  <button class="colab-df-quickchart" onclick="quickchart('df-007d05ea-fd5c-485d-95f5-63b6d5717990')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-007d05ea-fd5c-485d-95f5-63b6d5717990 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="60"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="W1mVd9nf-cNu" data-outputId="53f90f78-6138-44b8-ea1b-2eec606a00d3">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="60">
<pre><code>(5960, 13)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="61"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:11,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="f13cl_KX_aUG" data-outputId="21022f25-451e-4882-a2b1-5c1c4bc19b9f">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>data.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>BAD          int64
LOAN         int64
MORTDUE    float64
VALUE      float64
REASON      object
JOB         object
YOJ        float64
DEROG      float64
DELINQ     float64
CLAGE      float64
NINQ       float64
CLNO       float64
DEBTINC    float64
dtype: object</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="62"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="pXtLbKnm_h3g" data-outputId="efaa4aa6-c02a-48e5-ac6b-87d801d6515e">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="62">
<pre><code>BAD           0
LOAN          0
MORTDUE     518
VALUE       112
REASON      252
JOB         279
YOJ         515
DEROG       708
DELINQ      580
CLAGE       308
NINQ        510
CLNO        222
DEBTINC    1267
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="63"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="rB6zSdM7_pvV" data-outputId="fc7cabce-d2e0-49e0-c5de-7fc5640549f3">
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data.duplicated().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<pre><code>0</code></pre>
</div>
</div>
<section id="summary-statistics" class="cell markdown"
id="rHTODkjLuTCT">
<h2>Summary Statistics</h2>
</section>
<div class="cell code" data-execution_count="64"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661231419,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="z5GkNSwlWLVS" data-outputId="6c4a279e-d4df-4f9a-d67f-73d6f9d284f9">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> data.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_stats)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                BAD          LOAN        MORTDUE          VALUE   REASON  \
count   5960.000000   5960.000000    5442.000000    5848.000000     5708   
unique          NaN           NaN            NaN            NaN        2   
top             NaN           NaN            NaN            NaN  DebtCon   
freq            NaN           NaN            NaN            NaN     3928   
mean       0.199497  18607.969799   73760.817200  101776.048741      NaN   
std        0.399656  11207.480417   44457.609458   57385.775334      NaN   
min        0.000000   1100.000000    2063.000000    8000.000000      NaN   
25%        0.000000  11100.000000   46276.000000   66075.500000      NaN   
50%        0.000000  16300.000000   65019.000000   89235.500000      NaN   
75%        0.000000  23300.000000   91488.000000  119824.250000      NaN   
max        1.000000  89900.000000  399550.000000  855909.000000      NaN   

          JOB          YOJ        DEROG       DELINQ        CLAGE  \
count    5681  5445.000000  5252.000000  5380.000000  5652.000000   
unique      6          NaN          NaN          NaN          NaN   
top     Other          NaN          NaN          NaN          NaN   
freq     2388          NaN          NaN          NaN          NaN   
mean      NaN     8.922268     0.254570     0.449442   179.766275   
std       NaN     7.573982     0.846047     1.127266    85.810092   
min       NaN     0.000000     0.000000     0.000000     0.000000   
25%       NaN     3.000000     0.000000     0.000000   115.116702   
50%       NaN     7.000000     0.000000     0.000000   173.466667   
75%       NaN    13.000000     0.000000     0.000000   231.562278   
max       NaN    41.000000    10.000000    15.000000  1168.233561   

               NINQ         CLNO      DEBTINC  
count   5450.000000  5738.000000  4693.000000  
unique          NaN          NaN          NaN  
top             NaN          NaN          NaN  
freq            NaN          NaN          NaN  
mean       1.186055    21.296096    33.779915  
std        1.728675    10.138933     8.601746  
min        0.000000     0.000000     0.524499  
25%        0.000000    15.000000    29.140031  
50%        1.000000    20.000000    34.818262  
75%        2.000000    26.000000    39.003141  
max       17.000000    71.000000   203.312149  
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="65"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:871}"
data-executionInfo="{&quot;elapsed&quot;:409,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661232142,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="Ofso6Pexlhu5" data-outputId="4fc86bff-282c-455a-e23c-3c58d941c799">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary Statistics</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>summary_stats <span class="op">=</span> data.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Corrected Missing Values After Summary</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>missing_values_after_summary <span class="op">=</span> summary_stats.loc[<span class="st">&#39;count&#39;</span>].eq(<span class="bu">len</span>(data))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display Corrected Missing Values After Summary</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Corrected Missing Values After Summary:&quot;</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_values_after_summary)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized Missing Values</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>sns.heatmap(data.isnull(), cbar<span class="op">=</span><span class="va">False</span>, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Corrected Missing Values in the Dataset&#39;</span>)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Corrected Missing Values After Summary:
BAD         True
LOAN        True
MORTDUE    False
VALUE      False
REASON     False
JOB        False
YOJ        False
DEROG      False
DELINQ     False
CLAGE      False
NINQ       False
CLNO       False
DEBTINC    False
Name: count, dtype: bool
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/62fd033fc9fb09ffc23549c79c16f3e2eb0eb122.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="66"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661232142,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="sbVi1Akx8DQA" data-outputId="444e9f04-2543-4de9-c364-dde0e17dd466">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(summary_stats)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>                BAD          LOAN        MORTDUE          VALUE   REASON  \
count   5960.000000   5960.000000    5442.000000    5848.000000     5708   
unique          NaN           NaN            NaN            NaN        2   
top             NaN           NaN            NaN            NaN  DebtCon   
freq            NaN           NaN            NaN            NaN     3928   
mean       0.199497  18607.969799   73760.817200  101776.048741      NaN   
std        0.399656  11207.480417   44457.609458   57385.775334      NaN   
min        0.000000   1100.000000    2063.000000    8000.000000      NaN   
25%        0.000000  11100.000000   46276.000000   66075.500000      NaN   
50%        0.000000  16300.000000   65019.000000   89235.500000      NaN   
75%        0.000000  23300.000000   91488.000000  119824.250000      NaN   
max        1.000000  89900.000000  399550.000000  855909.000000      NaN   

          JOB          YOJ        DEROG       DELINQ        CLAGE  \
count    5681  5445.000000  5252.000000  5380.000000  5652.000000   
unique      6          NaN          NaN          NaN          NaN   
top     Other          NaN          NaN          NaN          NaN   
freq     2388          NaN          NaN          NaN          NaN   
mean      NaN     8.922268     0.254570     0.449442   179.766275   
std       NaN     7.573982     0.846047     1.127266    85.810092   
min       NaN     0.000000     0.000000     0.000000     0.000000   
25%       NaN     3.000000     0.000000     0.000000   115.116702   
50%       NaN     7.000000     0.000000     0.000000   173.466667   
75%       NaN    13.000000     0.000000     0.000000   231.562278   
max       NaN    41.000000    10.000000    15.000000  1168.233561   

               NINQ         CLNO      DEBTINC  
count   5450.000000  5738.000000  4693.000000  
unique          NaN          NaN          NaN  
top             NaN          NaN          NaN  
freq            NaN          NaN          NaN  
mean       1.186055    21.296096    33.779915  
std        1.728675    10.138933     8.601746  
min        0.000000     0.000000     0.524499  
25%        0.000000    15.000000    29.140031  
50%        1.000000    20.000000    34.818262  
75%        2.000000    26.000000    39.003141  
max       17.000000    71.000000   203.312149  
</code></pre>
</div>
</div>
<div class="cell markdown" id="g51vGZAGuTCT">
<ul>
<li>Observations from Summary Statistics</li>
</ul>
</div>
<section id="exploratory-data-analysis-eda-and-visualization"
class="cell markdown" id="3ZcMbNvZuTCW">
<h2><strong>Exploratory Data Analysis (EDA) and
Visualization</strong></h2>
</section>
<div class="cell markdown" id="_Td9x7DdBZti">
<ul>
<li>EDA is an important part of any project involving data.</li>
<li>It is important to investigate and understand the data better before
building a model with it.</li>
<li>A few questions have been mentioned below which will help you
approach the analysis in the right manner and generate insights from the
data.</li>
<li>A thorough analysis of the data, in addition to the questions
mentioned below, should be done.</li>
</ul>
</div>
<div class="cell markdown" id="ba_dqV0sBZti">
<p><strong>Leading Questions</strong>:</p>
<ol>
<li>What is the range of values for the loan amount variable
"LOAN"?</li>
<li>How does the distribution of years at present job "YOJ" vary across
the dataset?</li>
<li>How many unique categories are there in the REASON variable?</li>
<li>What is the most common category in the JOB variable?</li>
<li>Is there a relationship between the REASON variable and the
proportion of applicants who defaulted on their loan?</li>
<li>Do applicants who default have a significantly different loan amount
compared to those who repay their loan?</li>
<li>Is there a correlation between the value of the property and the
loan default rate?</li>
<li>Do applicants who default have a significantly different mortgage
amount compared to those who repay their loan?</li>
</ol>
</div>
<section id="univariate-analysis" class="cell markdown"
id="65yxFJFVuTCW">
<h3><strong>Univariate Analysis</strong></h3>
</section>
<div class="cell code" data-execution_count="67"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661232142,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="2zXcgmBeBZti" data-outputId="8e7fe729-9b2c-4abf-9496-02adb63ea5be">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the range of values for the loan amount variable &quot;LOAN&quot;?</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>loan_range <span class="op">=</span> data[<span class="st">&#39;LOAN&#39;</span>].<span class="bu">max</span>() <span class="op">-</span> data[<span class="st">&#39;LOAN&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Range of loan amounts: </span><span class="sc">{</span>loan_range<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Range of loan amounts: 88800
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="68"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:509,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661232648,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="vMa_HaMBDv1X" data-outputId="525b97d5-a708-460b-aa64-ba613bc30213">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized distribution of loan amounts.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data[<span class="st">&#39;LOAN&#39;</span>], bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Loan Amounts&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Amount&#39;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/d8062c5829f62d09f12e453416d6ba6f807dfa5b.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="69"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661232648,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="JmZs7eoMox6a" data-outputId="4c5dfc3b-f84b-40f8-f87d-eee92902fae1">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How does the distribution of years at present job &quot;YOJ&quot; vary across the dataset?</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>YOJ_Range <span class="op">=</span> data[<span class="st">&#39;YOJ&#39;</span>].<span class="bu">max</span>() <span class="op">-</span> data[<span class="st">&#39;YOJ&#39;</span>].<span class="bu">min</span>()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Range of YOJ amounts: </span><span class="sc">{</span>YOJ_Range<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Range of YOJ amounts: 41.0
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="70"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:493,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233138,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="xIqOxuExDzT7" data-outputId="571330df-3f6c-494f-ce2a-4303f77f78cf">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explored the distribution of years at present job &quot;YOJ.&quot;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sns.histplot(data[<span class="st">&#39;YOJ&#39;</span>].dropna(), bins<span class="op">=</span><span class="dv">20</span>, kde<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;lightcoral&#39;</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Years at Present Job&#39;</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Years at Present Job&#39;</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/45ba616297220fb58e37f83efd53c4be020d80e4.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="71"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233139,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="TvvbhYkdD2WW" data-outputId="9786e1a5-6d8f-416e-9d2c-a83df74d7c8a">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determined the number of unique categories in the REASON variable.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>reason_categories <span class="op">=</span> data[<span class="st">&#39;REASON&#39;</span>].nunique()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Number of unique categories in REASON: </span><span class="sc">{</span>reason_categories<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Number of unique categories in REASON: 2
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="72"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233139,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="NTmCRf8GE8Gu" data-outputId="6310821b-c446-4793-81d6-af80c051ccca">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checked unique values in the &quot;REASON&quot; column</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>unique_reasons <span class="op">=</span> data[<span class="st">&#39;REASON&#39;</span>].unique()</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(unique_reasons)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;HomeImp&#39; nan &#39;DebtCon&#39;]
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="73"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:632}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233139,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="d-5Y4eLPFD3c" data-outputId="c65e49f3-fa10-49c8-866b-b342a4ec2946">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there a relationship between the REASON variable and the proportion of applicants who defaulted on their loan?</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>reason_counts <span class="op">=</span> data[<span class="st">&#39;REASON&#39;</span>].value_counts()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the distribution of applicants based on the reason for the loan using a bar plot</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>reason_counts.plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Applicants by Loan Reason&#39;</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Reason&#39;</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Applicants&#39;</span>)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/5c9ee344d4a9bb3b571751afbbc1dbc4df7dd547.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="74"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233139,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="N_5crbC0KMEZ" data-outputId="9a66a2bf-a2c6-4c7b-d13a-60e907101fa3">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checked unique values in the &#39;JOB&#39; column</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;JOB&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="74">
<pre><code>array([&#39;Other&#39;, nan, &#39;Office&#39;, &#39;Sales&#39;, &#39;Mgr&#39;, &#39;ProfExe&#39;, &#39;Self&#39;],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="75"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:628}"
data-executionInfo="{&quot;elapsed&quot;:693,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233826,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="gDBtDFzgJm94" data-outputId="e421c276-8835-4ecd-ab74-409a45ff7fa2">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># What were the most common Job Categories?</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;JOB&#39;</span>].replace({np.nan: <span class="st">&#39;Unknown&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the distribution of job categories.</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;JOB&#39;</span>].value_counts().sort_index().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Job Categories&#39;</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Job Categories&#39;</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Number of Applicants&#39;</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/5b89cf62e8155fe8fb0825aac37e0da07ba0cb01.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="76"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661233827,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="GNgCdgbCJ9AA" data-outputId="1f7df1e6-625d-4323-ba2c-b5910c8e306d">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Created a bar plot showing the default rate for each loan reason category.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;REASON&#39;</span>, y<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Default Rate by Loan Reason&#39;</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Reason&#39;</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Proportion of Defaults&#39;</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/66a3ae1f2cd6e9fe02809fc7bdb47e0a3c648e11.png" /></p>
</div>
</div>
<section id="bivariate-analysis" class="cell markdown"
id="jg5IFtbouTCa">
<h3><strong>Bivariate Analysis</strong></h3>
</section>
<div class="cell code" data-execution_count="77"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:727}"
data-executionInfo="{&quot;elapsed&quot;:436,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661234257,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="M6FEto57JEkZ" data-outputId="f1eee39e-9998-486e-a2fb-d20973265604">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot of Loan Amount vs. Property Value</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LOAN&#39;</span>, y<span class="op">=</span><span class="st">&#39;VALUE&#39;</span>, data<span class="op">=</span>data, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Loan Amount vs. Property Value&#39;</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Amount&#39;</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Property Value&#39;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/d986ed81a4c923eefd22ff82c30320532412ddc1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="78"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:8,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661234257,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="92qBBDj7DyAD" data-outputId="3917da24-6345-4c26-b306-9f4e97bcb2f8">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the distribution of years at present job &quot;YOJ&quot; across loan default categories</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, y<span class="op">=</span><span class="st">&#39;YOJ&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Years at Present Job by Loan Default Category&#39;</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Default Category (0: No, 1: Yes)&#39;</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Years at Present Job (YOJ)&#39;</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/9d1b5ae43c08d26affa641833d959bf39ccde317.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="79"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661234257,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="8v7mtVplDyi_" data-outputId="ffb95013-cfbb-44e2-88d1-ebd397ed3425">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the distribution of loan amounts for defaulted and repaid loans</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, y<span class="op">=</span><span class="st">&#39;LOAN&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Comparison of Loan Amounts for Defaulted and Repaid Loans&#39;</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Default Category (0: No, 1: Yes)&#39;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loan Amount&#39;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/87d9f90ab1b76a91b8a9a0f111aadf8018d269df.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="80"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:538,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661234789,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="9b60NSTMBZtj" data-outputId="dea0d0d8-2d66-40cb-d9d4-2856a90eefd7">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the correlation between property value and loan default rate</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;VALUE&#39;</span>, y<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, data<span class="op">=</span>data, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation between Property Value and Loan Default Rate&#39;</span>)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Property Value&#39;</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loan Default Category (0: No, 1: Yes)&#39;</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/451365b527779db00252539bf5451d82fafe4993.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="81"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661234789,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="LSGcgDPt3BD6" data-outputId="28270a16-6ec9-49f1-a165-b440d01f1760">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the distribution of mortgage amounts for defaulted and repaid loans</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, y<span class="op">=</span><span class="st">&#39;MORTDUE&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Comparison of Mortgage Amounts for Defaulted and Repaid Loans&#39;</span>)</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Default Category (0: No, 1: Yes)&#39;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Mortgage Amount&#39;</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/1221221b537b582620ad17628b077193869e13c5.png" /></p>
</div>
</div>
<section id="multivariate-analysis" class="cell markdown"
id="pc9wZJcGuTCm">
<h3><strong>Multivariate Analysis</strong></h3>
</section>
<div class="cell code" data-execution_count="82"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:727}"
data-executionInfo="{&quot;elapsed&quot;:412,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661235193,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="nLk0Fgx-BZtj" data-outputId="2e8edbdc-c48c-4cfb-e6dd-a3b7b5e68be2">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized relationship between loan amount, property value, and loan default</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;LOAN&#39;</span>, y<span class="op">=</span><span class="st">&#39;VALUE&#39;</span>, hue<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>, size<span class="op">=</span><span class="st">&#39;LOAN&#39;</span>, sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Relationship Between Loan Amount, Property Value, and Loan Default&#39;</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Loan Amount&#39;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Property Value&#39;</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/38b9386946686917c866245a449202986a6a8f8f.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="83"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:727}"
data-executionInfo="{&quot;elapsed&quot;:728,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661235917,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="Z5pSL_L13ivj" data-outputId="9e6e6865-a6af-4aab-c7c1-147bbc1157f3">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized relationship between debt-to-income ratio, loan amount, and loan default</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(x<span class="op">=</span><span class="st">&#39;DEBTINC&#39;</span>, y<span class="op">=</span><span class="st">&#39;LOAN&#39;</span>, hue<span class="op">=</span><span class="st">&#39;BAD&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>, size<span class="op">=</span><span class="st">&#39;DEBTINC&#39;</span>, sizes<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">200</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Relationship Between Debt-to-Income Ratio, Loan Amount, and Loan Default&#39;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Debt-to-Income Ratio&#39;</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Loan Amount&#39;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/7cbd66a7cd8c6bd4e6f95d165bd31c33e8dafd39.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="84"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:573}"
data-executionInfo="{&quot;elapsed&quot;:267,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661236179,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="hTrxPMBE3nHM" data-outputId="b9ea677a-163d-48f6-e74c-54a7083b294c">
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized comparison of debt-to-income ratio for different job categories</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&#39;JOB&#39;</span>, y<span class="op">=</span><span class="st">&#39;DEBTINC&#39;</span>, data<span class="op">=</span>data, palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Comparison of Debt-to-Income Ratio for Different Job Categories&#39;</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Job Categories&#39;</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Debt-to-Income Ratio&#39;</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/e06e05301b83c44ef4d1dee5db45c83d20871ded.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="85"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:703}"
data-executionInfo="{&quot;elapsed&quot;:630,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661236806,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="5MdvhpzR4LJx" data-outputId="7671e595-e922-4d9a-bb57-0e3308a25d41">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculated correlation matrix</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> data.corr()</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualized the correlation matrix using a heatmap</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>sns.heatmap(correlation_matrix, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>, linewidths<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Correlation Matrix&#39;</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/4b08602f3bd815c46190e71f24b7dd3101fb2027.png" /></p>
</div>
</div>
<div class="cell markdown" id="g9IjJUZfZ2hr">
<p>DELINQ has a strong positive correlation with BAD. This indicates
that having a higher number of delinquesnt credit lines indicates a
higher likelihood of default.</p>
<p>CLAGE has a moderate negative correlation with BAD. This means that
on average, older lines of dcredit are less likely to default.</p>
<p>DEBTINC has a moderate positive correlation wtih BAD. This means that
higher debt to income ratios are correlated with a higher likelihood of
default.</p>
<p>LOAN has a weak negative correlation with BAD. This means that the
loan total is not correlated with the likelihood of default</p>
<p>YOJ has a weak negative correlation with BAD, this means that the
number of years at their current job does not strongly predict
likelihood of default.</p>
<p>DEROG has a weak positive correlation wtih BAD, meaning that
derogatory reports are not a strong indicator of defaulting.</p>
<p>In the correlation matrix, Mortdue and VALUE had a strong correlation
indicating that ammount due on the property was strongly tied to the
property value. Other variables were not as strongly related.</p>
<p>Overall, most variables here are not strong tellers of what is a
factor that increases likelihood of defaulting espescially since the
highest score was 0.35, further investigation is needed.</p>
</div>
<div class="cell code" data-execution_count="86"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661236807,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="aDO3tyX-4j8r" data-outputId="7f83e0db-79f2-4cee-b26a-f7028ae276c6">
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(correlation_matrix)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              BAD      LOAN   MORTDUE     VALUE       YOJ     DEROG    DELINQ  \
BAD      1.000000 -0.075099 -0.048219 -0.029954 -0.060238  0.276081  0.354107   
LOAN    -0.075099  1.000000  0.228595  0.335393  0.105728 -0.001302 -0.035144   
MORTDUE -0.048219  0.228595  1.000000  0.875666 -0.088480 -0.049516 -0.001044   
VALUE   -0.029954  0.335393  0.875666  1.000000  0.007759 -0.048689 -0.014103   
YOJ     -0.060238  0.105728 -0.088480  0.007759  1.000000 -0.065879  0.038153   
DEROG    0.276081 -0.001302 -0.049516 -0.048689 -0.065879  1.000000  0.211832   
DELINQ   0.354107 -0.035144 -0.001044 -0.014103  0.038153  0.211832  1.000000   
CLAGE   -0.170499  0.088540  0.140047  0.171238  0.201718 -0.083047  0.022488   
NINQ     0.174980  0.044487  0.031392 -0.004398 -0.071627  0.173934  0.067812   
CLNO    -0.004157  0.072631  0.323631  0.269149  0.024838  0.061884  0.164639   
DEBTINC  0.199835  0.084735  0.154939  0.132174 -0.055891  0.017065  0.052364   

            CLAGE      NINQ      CLNO   DEBTINC  
BAD     -0.170499  0.174980 -0.004157  0.199835  
LOAN     0.088540  0.044487  0.072631  0.084735  
MORTDUE  0.140047  0.031392  0.323631  0.154939  
VALUE    0.171238 -0.004398  0.269149  0.132174  
YOJ      0.201718 -0.071627  0.024838 -0.055891  
DEROG   -0.083047  0.173934  0.061884  0.017065  
DELINQ   0.022488  0.067812  0.164639  0.052364  
CLAGE    1.000000 -0.116935  0.237987 -0.046477  
NINQ    -0.116935  1.000000  0.088389  0.141344  
CLNO     0.237987  0.088389  1.000000  0.185539  
DEBTINC -0.046477  0.141344  0.185539  1.000000  
</code></pre>
</div>
</div>
<section id="treating-outliers" class="cell markdown" id="zEjMlq0quTCp">
<h2>Treating Outliers</h2>
</section>
<div class="cell code" data-execution_count="87"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:1427,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661238228,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="A5gsJB233mjw" data-outputId="633ed762-e71e-45da-e2e2-d9a32ab9877f">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selected variables for box plots</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>variables_of_interest <span class="op">=</span> [<span class="st">&#39;LOAN&#39;</span>, <span class="st">&#39;MORTDUE&#39;</span>, <span class="st">&#39;VALUE&#39;</span>, <span class="st">&#39;YOJ&#39;</span>, <span class="st">&#39;DEROG&#39;</span>, <span class="st">&#39;DELINQ&#39;</span>, <span class="st">&#39;CLAGE&#39;</span>, <span class="st">&#39;NINQ&#39;</span>, <span class="st">&#39;CLNO&#39;</span>, <span class="st">&#39;DEBTINC&#39;</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Created box plots</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">10</span>))</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, variable <span class="kw">in</span> <span class="bu">enumerate</span>(variables_of_interest, <span class="dv">1</span>):</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">5</span>, i)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(data[variable], color<span class="op">=</span><span class="st">&#39;skyblue&#39;</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f&#39;Box Plot of </span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">&#39;</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(variable)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Displayed box plots</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary stats for the selected variables</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Summary Statistics for Selected Variables:&quot;</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[variables_of_interest].describe().transpose())</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Id&#39;d potential outliers based on IQR</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_outliers_iqr(series):</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    q1 <span class="op">=</span> series.quantile(<span class="fl">0.25</span>)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>    q3 <span class="op">=</span> series.quantile(<span class="fl">0.75</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>    iqr <span class="op">=</span> q3 <span class="op">-</span> q1</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> iqr</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> (series <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (series <span class="op">&gt;</span> upper_bound)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outliers</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed Potential Outliers</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Potential Outliers Based on IQR:&quot;</span>)</span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> variable <span class="kw">in</span> variables_of_interest:</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> identify_outliers_iqr(data[variable])</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>variable<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>outliers<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> potential outliers&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/c721efbc3fb791d54a4127f2e9f84560fce79e1f.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Summary Statistics for Selected Variables:
          count           mean           std          min           25%  \
LOAN     5960.0   18607.969799  11207.480417  1100.000000  11100.000000   
MORTDUE  5442.0   73760.817200  44457.609458  2063.000000  46276.000000   
VALUE    5848.0  101776.048741  57385.775334  8000.000000  66075.500000   
YOJ      5445.0       8.922268      7.573982     0.000000      3.000000   
DEROG    5252.0       0.254570      0.846047     0.000000      0.000000   
DELINQ   5380.0       0.449442      1.127266     0.000000      0.000000   
CLAGE    5652.0     179.766275     85.810092     0.000000    115.116702   
NINQ     5450.0       1.186055      1.728675     0.000000      0.000000   
CLNO     5738.0      21.296096     10.138933     0.000000     15.000000   
DEBTINC  4693.0      33.779915      8.601746     0.524499     29.140031   

                  50%            75%            max  
LOAN     16300.000000   23300.000000   89900.000000  
MORTDUE  65019.000000   91488.000000  399550.000000  
VALUE    89235.500000  119824.250000  855909.000000  
YOJ          7.000000      13.000000      41.000000  
DEROG        0.000000       0.000000      10.000000  
DELINQ       0.000000       0.000000      15.000000  
CLAGE      173.466667     231.562278    1168.233561  
NINQ         1.000000       2.000000      17.000000  
CLNO        20.000000      26.000000      71.000000  
DEBTINC     34.818262      39.003141     203.312149  

Potential Outliers Based on IQR:
LOAN: 256 potential outliers
MORTDUE: 234 potential outliers
VALUE: 320 potential outliers
YOJ: 91 potential outliers
DEROG: 725 potential outliers
DELINQ: 1201 potential outliers
CLAGE: 47 potential outliers
NINQ: 177 potential outliers
CLNO: 219 potential outliers
DEBTINC: 94 potential outliers
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="88"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:362,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661238587,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="WTtFHgKTBZtj" data-outputId="91694891-b069-4875-b3a4-40e2331ebefa">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Outlier Adjustment based on IQR</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> treat_outliers(data, column):</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> data[column].quantile(<span class="fl">0.25</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> data[column].quantile(<span class="fl">0.75</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identifed Outliers</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> (data[column] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (data[column] <span class="op">&gt;</span> upper_bound)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Treated outliers</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    data.loc[outliers, column] <span class="op">=</span> np.nan</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> data</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Columns with potential outliers</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>columns_with_outliers <span class="op">=</span> [<span class="st">&#39;LOAN&#39;</span>, <span class="st">&#39;MORTDUE&#39;</span>, <span class="st">&#39;VALUE&#39;</span>, <span class="st">&#39;YOJ&#39;</span>, <span class="st">&#39;DEROG&#39;</span>, <span class="st">&#39;DELINQ&#39;</span>, <span class="st">&#39;CLAGE&#39;</span>, <span class="st">&#39;NINQ&#39;</span>, <span class="st">&#39;CLNO&#39;</span>, <span class="st">&#39;DEBTINC&#39;</span>]</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Treated outliers in each column</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns_with_outliers:</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> treat_outliers(data, column)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary Stats after outlier resolution</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data[columns_with_outliers].describe())</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots Post-Outlier Resolution</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">8</span>))</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>data[columns_with_outliers])</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Boxplots after Treating Outliers&#39;</span>)</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>               LOAN        MORTDUE          VALUE          YOJ   DEROG  \
count   5704.000000    5208.000000    5528.000000  5354.000000  4527.0   
mean   16995.038569   67623.862942   92638.820738     8.548067     0.0   
std     7965.198387   32936.478948   38895.830184     7.059202     0.0   
min     1100.000000    2063.000000    8000.000000     0.000000     0.0   
25%    10900.000000   45498.250000   65000.000000     3.000000     0.0   
50%    15900.000000   63508.000000   86908.000000     7.000000     0.0   
75%    22300.000000   87000.000000  114220.250000    13.000000     0.0   
max    41600.000000  159000.000000  200339.000000    28.000000     0.0   

       DELINQ        CLAGE         NINQ         CLNO      DEBTINC  
count  4179.0  5605.000000  5273.000000  5519.000000  4599.000000  
mean      0.0   176.727344     0.962261    20.181011    33.776951  
std       0.0    78.075515     1.190782     8.558459     6.638178  
min       0.0     0.000000     0.000000     0.000000    14.370986  
25%       0.0   114.759019     0.000000    14.000000    29.304810  
50%       0.0   172.432355     1.000000    20.000000    34.880462  
75%       0.0   229.406175     2.000000    26.000000    38.974704  
max       0.0   405.867848     5.000000    42.000000    53.584883  
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/f216e8024ce89609e299ac6284f8da9a473000a9.png" /></p>
</div>
</div>
<section id="treating-missing-values" class="cell markdown"
id="U8CEq24hBZtj">
<h2>Treating Missing Values</h2>
</section>
<div class="cell code" data-execution_count="89"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661238587,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="CDYGPOlXBZtk" data-outputId="87d45b58-d58b-4295-fbd8-70cbf7d8dce3">
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>data.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="89">
<pre><code>BAD           0
LOAN        256
MORTDUE     752
VALUE       432
REASON      252
JOB           0
YOJ         606
DEROG      1433
DELINQ     1781
CLAGE       355
NINQ        687
CLNO        441
DEBTINC    1361
dtype: int64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="90"
data-executionInfo="{&quot;elapsed&quot;:1146,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661239729,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="9sUeY2dPLCoc">
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNN to resolve missing values in the &quot;data&quot; DataFrame</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>data_imputed <span class="op">=</span> data.copy()</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Identified numeric and categorical columns</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>numeric_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;number&#39;</span>]).columns</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> data.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;object&#39;</span>]).columns</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Impute missing values for numeric columns</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>numeric_imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>data_imputed[numeric_columns] <span class="op">=</span> numeric_imputer.fit_transform(data[numeric_columns])</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Label encode categorical columns</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>label_encoder <span class="op">=</span> LabelEncoder()</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>    data_imputed[col] <span class="op">=</span> label_encoder.fit_transform(data[col])</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputed missing values for the entire DataFrame</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>data_imputed <span class="op">=</span> pd.DataFrame(imputer.fit_transform(data_imputed), columns<span class="op">=</span>data_imputed.columns)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_columns:</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>    data_imputed[col] <span class="op">=</span> label_encoder.inverse_transform(data_imputed[col].astype(<span class="bu">int</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="91"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661239730,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="TJcXXFHdM1rn" data-outputId="7bb86c70-2d5b-4c5f-f45f-eca78d354fe8">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(data_imputed.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>BAD        0
LOAN       0
MORTDUE    0
VALUE      0
REASON     0
JOB        0
YOJ        0
DEROG      0
DELINQ     0
CLAGE      0
NINQ       0
CLNO       0
DEBTINC    0
dtype: int64
</code></pre>
</div>
</div>
<section id="important-insights-from-eda" class="cell markdown"
id="eG_XM04vuTCs">
<h2><strong>Important Insights from EDA</strong></h2>
<p>What are the the most important observations and insights from the
data based on the EDA performed?</p>
</section>
<div class="cell markdown" id="QE0VMFMnjU-Y">
<p><strong><em>Important Insights from EDA:</em></strong></p>
<ol>
<li><strong>Loan Amount Distribution:</strong>
<ul>
<li>The distribution of loan amounts tends towards the lower end of the
range, with a predominant concentration between 50,000 and 200,000.
Notably, there is a sharp drop-off in frequencies beyond 300,000.</li>
</ul></li>
<li><strong>Years at Present Job (YOJ) Distribution:</strong>
<ul>
<li>The majority of applicants are in the early stages of their present
job, with the distribution strongest at 0-1 years before gradually
tapering down, reaching a minimum around 30 years.</li>
</ul></li>
<li><strong>Reason Variable and Loan Default:</strong>
<ul>
<li>The REASON variable, with categories HomeImp and DebtCon, showed
similar distribution patterns, with HomeImp at 21 and DebtCon at about
19. Further analysis is needed to determine if there are significant
differences in default rates based on the reason variable.</li>
</ul></li>
<li><strong>Relationship Between Loan Amount/Mortgage Amount and
Default:</strong>
<ul>
<li>Applicants who default tend to have lower loan amounts and mortgage
amounts. Detailed statistical analysis is required to assess the
significance of these differences and their impact on default
rates.</li>
</ul></li>
<li><strong>Correlation Between Property Value and Loan Default
Rate:</strong>
<ul>
<li>There appears to be a correlation between the value of the property
and the loan default rate. Further investigation is needed to explore
the nature and strength of this correlation.</li>
</ul></li>
<li><strong>Further Investigation:</strong>
<ul>
<li>While the observed trends indicate a tendency for lower loans and
mortgages in defaulted cases, additional analyses are necessary to
identify the specific factors influencing loan default rates. Subsequent
investigations may include examining the impact of employment status,
debt-to-income ratio, and other relevant features.</li>
</ul></li>
</ol>
</div>
<section id="model-building---approach" class="cell markdown"
id="Cdqhtr8yuS-L">
<h2><strong>Model Building - Approach</strong></h2>
<ul>
<li>Data preparation</li>
<li>Partition the data into train and test set</li>
<li>Build the model</li>
<li>Fit on the train data</li>
<li>Tune the model</li>
<li>Test the model on test set</li>
</ul>
</section>
<section id="logistic-regression" class="cell markdown"
id="2CGW7uh5BZtk">
<h3>Logistic Regression</h3>
</section>
<div class="cell code" data-execution_count="92"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1736,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661241463,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="fs0QKb4ABZtk" data-outputId="2f762853-b493-483c-d864-d55b6cab0bb0">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Imputed missing values for the entire DataFrame before the split</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>data_imputed <span class="op">=</span> pd.DataFrame(imputer.fit_transform(data_encoded), columns<span class="op">=</span>data_encoded.columns)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_imputed.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_imputed[target_column]</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Built and Evaluated Logistic Regression Model with KNN-imputed data</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>logreg_model <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>logreg_model.fit(X_train, y_train)</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>y_logreg_pred <span class="op">=</span> logreg_model.predict(X_test)</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>accuracy_logreg <span class="op">=</span> accuracy_score(y_test, y_logreg_pred)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>classification_rep_logreg <span class="op">=</span> classification_report(y_test, y_logreg_pred)</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Logistic Regression with KNN Imputation of 5:&#39;</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy: </span><span class="sc">{</span>accuracy_logreg<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Classification Report:</span><span class="ch">\n</span><span class="st">&#39;</span>, classification_rep_logreg)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Logistic Regression with KNN Imputation of 5:
Accuracy: 0.7928
Classification Report:
               precision    recall  f1-score   support

         0.0       0.80      0.98      0.88       927
         1.0       0.68      0.13      0.22       265

    accuracy                           0.79      1192
   macro avg       0.74      0.56      0.55      1192
weighted avg       0.77      0.79      0.73      1192

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="93"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4317,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661245777,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="-wIpnDahHClz" data-outputId="07696a69-9486-4215-ff82-dae81d2779dd">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pip install <span class="op">-</span>U imbalanced<span class="op">-</span>learn</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: imbalanced-learn in /usr/local/lib/python3.10/dist-packages (0.11.0)
Requirement already satisfied: numpy&gt;=1.17.3 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.23.5)
Requirement already satisfied: scipy&gt;=1.5.0 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.11.4)
Requirement already satisfied: scikit-learn&gt;=1.0.2 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.2.2)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from imbalanced-learn) (3.2.0)
</code></pre>
</div>
</div>
<div class="cell markdown" id="MAVDGRGFX6kC">
<p>Logistic regression with unbalanced target variables leads to low
recall for the target variable class. From here onwards I used SMOTE
imputation to account for the unbalanced variables.</p>
</div>
<div class="cell code" data-execution_count="94"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1327,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661247100,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="wmMhAoEIHLbA" data-outputId="0d660fdc-c382-43f9-866f-2b1bd288e246">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Split Up data</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set KNNImputer to 5 to see if accuracy and scores improve on the model.</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train)</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-Built and Evaluated Logistic Regression Model with SMOTE</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>logreg_model_smote <span class="op">=</span> LogisticRegression(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>logreg_model_smote.fit(X_train_smote, y_train_smote)</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>y_logreg_smote_pred <span class="op">=</span> logreg_model_smote.predict(X_test_imputed)</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>accuracy_logreg_smote <span class="op">=</span> accuracy_score(y_test, y_logreg_smote_pred)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>classification_rep_logreg_smote <span class="op">=</span> classification_report(y_test, y_logreg_smote_pred)</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">Logistic Regression with SMOTE Oversampling:&#39;</span>)</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy: </span><span class="sc">{</span>accuracy_logreg_smote<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Classification Report:</span><span class="ch">\n</span><span class="st">&#39;</span>, classification_rep_logreg_smote)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Logistic Regression with SMOTE Oversampling:
Accuracy: 0.6409
Classification Report:
               precision    recall  f1-score   support

           0       0.88      0.63      0.73       927
           1       0.35      0.69      0.46       265

    accuracy                           0.64      1192
   macro avg       0.61      0.66      0.60      1192
weighted avg       0.76      0.64      0.67      1192

</code></pre>
</div>
</div>
<div class="cell markdown" id="3M_hWDR61n6M">

</div>
<section id="decision-tree" class="cell markdown" id="9oYAeptGBZtk">
<h3>Decision Tree</h3>
</section>
<div class="cell code" data-execution_count="95"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1169,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661248266,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="nfvaEVqsBZtk" data-outputId="db18dc3f-d3cf-4c28-ea51-610b95c3c25d">
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Built and Evaluated Decision Tree Model with SMOTE</span></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>dt_model_smote <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>, max_depth<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>dt_model_smote.fit(X_train_smote, y_train_smote)</span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluated Decision Tree Model with SMOTE</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a>y_dt_smote_pred <span class="op">=</span> dt_model_smote.predict(X_test_imputed)</span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true" tabindex="-1"></a>classification_rep_dt_smote <span class="op">=</span> classification_report(y_test, y_dt_smote_pred)</span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Decision Tree Classification Report with SMOTE:&#39;</span>)</span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_rep_dt_smote)</span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Decision Tree Classification Report with SMOTE:
              precision    recall  f1-score   support

           0       0.88      0.88      0.88       927
           1       0.59      0.58      0.59       265

    accuracy                           0.82      1192
   macro avg       0.74      0.73      0.73      1192
weighted avg       0.82      0.82      0.82      1192

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="96"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:6033,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661254297,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="icnSgJ2yIftE" data-outputId="f6080ef9-61f1-4ece-ec20-223c96d13903">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defined the Hyperparameter Grid</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>],</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Performed Grid Search for hyperparameter tuning</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>dt_model_smote, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train_imputed, y_train)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Best hyperparameters</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> grid_search.best_params_</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Hyperparameters:&quot;</span>, best_params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Hyperparameters: {&#39;max_depth&#39;: 10, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 2}
</code></pre>
</div>
</div>
<div class="cell markdown" id="HdO4E2btpoPD">
<p><strong>Decision Tree - Hyperparameter Tuning</strong></p>
<ul>
<li>Hyperparameter tuning is tricky in the sense that <strong>there is
no direct way to calculate how a change in the hyperparameter value will
reduce the loss of your model</strong>, so we usually resort to
experimentation. We'll use Grid search to perform hyperparameter
tuning.</li>
<li><strong>Grid search is a tuning technique that attempts to compute
the optimum values of hyperparameters.</strong></li>
<li><strong>It is an exhaustive search</strong> that is performed on the
specific parameter values of a model.</li>
<li>The parameters of the estimator/model used to apply these methods
are <strong>optimized by cross-validated grid-search</strong> over a
parameter grid.</li>
</ul>
<p><strong>Criterion {“gini”, “entropy”}</strong></p>
<p>The function to measure the quality of a split. Supported criteria
are “gini” for the Gini impurity and “entropy” for the information
gain.</p>
<p><strong>max_depth</strong></p>
<p>The maximum depth of the tree. If None, then nodes are expanded until
all leaves are pure or until all leaves contain less than
min_samples_split samples.</p>
<p><strong>min_samples_leaf</strong></p>
<p>The minimum number of samples is required to be at a leaf node. A
split point at any depth will only be considered if it leaves at least
min_samples_leaf training samples in each of the left and right
branches. This may have the effect of smoothing the model, especially in
regression.</p>
<p>You can learn about more Hyperpapameters on this link and try to tune
them.</p>
<p><a
href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html"
class="uri">https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html</a></p>
</div>
<div class="cell code" data-execution_count="97"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:47609,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661301903,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="2iCyNU8iKYkt" data-outputId="2d931e19-a110-471c-a640-b2f2ac608e2c">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, train_test_split</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier, plot_tree</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># KNN Imputation</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train)</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameter Tuning with GridSearchCV and SMOTE</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>],</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Created a Decision Tree Classifier</span></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>dt_classifier <span class="op">=</span> DecisionTreeClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Performed Grid Search for hyperparameter tuning</span></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>dt_classifier, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_train_smote, y_train_smote)</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Best hyperparameters</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> grid_search.best_params_</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Hyperparameters:&quot;</span>, best_params)</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Created and Fit the Tuned Decision Tree Model with KNN-imputed data and SMOTE</span></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>best_dt_model_smote <span class="op">=</span> DecisionTreeClassifier(<span class="op">**</span>best_params, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>best_dt_model_smote.fit(X_train_smote, y_train_smote)</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluated the Tuned Decision Tree Model with SMOTE using imputed test set</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>y_best_dt_smote_pred <span class="op">=</span> best_dt_model_smote.predict(X_test_imputed)</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>accuracy_best_dt_smote <span class="op">=</span> accuracy_score(y_test, y_best_dt_smote_pred)</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>classification_rep_best_dt_smote <span class="op">=</span> classification_report(y_test, y_best_dt_smote_pred)</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="ch">\n</span><span class="st">Tuned Decision Tree with Best Parameters and SMOTE:&#39;</span>)</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Accuracy: </span><span class="sc">{</span>accuracy_best_dt_smote<span class="sc">:.4f}</span><span class="ss">&#39;</span>)</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Classification Report:</span><span class="ch">\n</span><span class="st">&#39;</span>, classification_rep_best_dt_smote)</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotted Tuned Decision Tree with SMOTE</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>plot_tree(best_dt_model_smote, filled<span class="op">=</span><span class="va">True</span>, feature_names<span class="op">=</span>X.columns, class_names<span class="op">=</span>[<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>], fontsize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Tuned Decision Tree Visualization with SMOTE&quot;</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Hyperparameters: {&#39;max_depth&#39;: 20, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 2}

Tuned Decision Tree with Best Parameters and SMOTE:
Accuracy: 0.8171
Classification Report:
               precision    recall  f1-score   support

           0       0.88      0.88      0.88       927
           1       0.59      0.58      0.59       265

    accuracy                           0.82      1192
   macro avg       0.74      0.73      0.73      1192
weighted avg       0.82      0.82      0.82      1192

</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/445a89169bde7f06d197e9e61e5ca8af6bf32eff.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="98"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2136,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661304029,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="jWhko5mNvpYp" data-outputId="fe7bb9d7-179d-45f5-8262-2f46e15b2c63">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, accuracy_score</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Untuned Random Forest with SMOTE</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>rf_classifier_smote <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the SMOTE oversampled data</span></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>rf_classifier_smote.fit(X_train_smote, y_train_smote)</span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>y_pred_rf_smote <span class="op">=</span> rf_classifier_smote.predict(X_test_imputed)</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate the untuned Random Forest model with SMOTE</span></span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a>accuracy_rf_smote <span class="op">=</span> accuracy_score(y_test, y_pred_rf_smote)</span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>classification_report_rf_smote <span class="op">=</span> classification_report(y_test, y_pred_rf_smote)</span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Untuned RF Accuracy Score with SMOTE</span></span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Untuned RF Accuracy with SMOTE:&quot;</span>, accuracy_rf_smote)</span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Untuned RF Classification Report with SMOTE:&quot;</span>)</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report_rf_smote)</span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Untuned RF Accuracy with SMOTE: 0.886744966442953
Untuned RF Classification Report with SMOTE:
              precision    recall  f1-score   support

           0       0.90      0.97      0.93       927
           1       0.84      0.61      0.70       265

    accuracy                           0.89      1192
   macro avg       0.87      0.79      0.82      1192
weighted avg       0.88      0.89      0.88      1192

</code></pre>
</div>
</div>
<div class="cell markdown" id="uhhASibj0ktW">

</div>
<section id="random-forest-classifier-hyperparameter-tuning"
class="cell markdown" id="HAx1Ooocp72i">
<h3><strong>Random Forest Classifier Hyperparameter Tuning</strong></h3>
</section>
<div class="cell code" data-execution_count="99"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:169975,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661474001,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="9UQIxCZcqJHa" data-outputId="f2fab80c-5762-49e5-edb7-5e85842bbcc7">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV, train_test_split</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set within each iteration of cross-validation</span></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>X_train_imputed_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Defined the hyperparameter grid for tuning</span></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;n_estimators&#39;</span>: [<span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">150</span>],</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;max_depth&#39;</span>: [<span class="va">None</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>],</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_split&#39;</span>: [<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>],</span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;min_samples_leaf&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Re-built RF Classifier</span></span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a>rf_classifier_tuned <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Performed Grid Search for hyperparameter tuning with SMOTE-augmented data</span></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>rf_grid_search <span class="op">=</span> GridSearchCV(estimator<span class="op">=</span>rf_classifier_tuned, param_grid<span class="op">=</span>param_grid, cv<span class="op">=</span><span class="dv">3</span>, scoring<span class="op">=</span><span class="st">&#39;accuracy&#39;</span>, n_jobs<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a>rf_grid_search.fit(X_train_imputed_smote, y_train_smote)</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Best hyperparameters</span></span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> rf_grid_search.best_params_</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Best Hyperparameters:&quot;</span>, best_params)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Best Hyperparameters: {&#39;max_depth&#39;: None, &#39;min_samples_leaf&#39;: 1, &#39;min_samples_split&#39;: 2, &#39;n_estimators&#39;: 150}
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="100"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2681,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661476679,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="5OyhS43XE-yN" data-outputId="d3aa3db5-43d3-4a5b-bb54-9596412fac22">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted the tuned Random Forest model with best hyperparameters</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: <span class="va">None</span>, <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">150</span>}</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>rf_model_tuned <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>, <span class="op">**</span>best_params)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>rf_model_tuned.fit(X_train_smote, y_train_smote)</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions on the test set</span></span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>y_pred_rf_tuned <span class="op">=</span> rf_model_tuned.predict(X_test_imputed)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluated tuned Random Forest model</span></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>accuracy_rf_tuned <span class="op">=</span> accuracy_score(y_test, y_pred_rf_tuned)</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a>classification_report_rf_tuned <span class="op">=</span> classification_report(y_test, y_pred_rf_tuned)</span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Tuned RF Accuracy score</span></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned RF Accuracy:&quot;</span>, accuracy_rf_tuned)</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Tuned RF Classification Report:&quot;</span>)</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report_rf_tuned)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tuned RF Accuracy: 0.8884228187919463
Tuned RF Classification Report:
              precision    recall  f1-score   support

           0       0.90      0.96      0.93       927
           1       0.83      0.63      0.72       265

    accuracy                           0.89      1192
   macro avg       0.86      0.80      0.82      1192
weighted avg       0.88      0.89      0.88      1192

</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="101"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:3222,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661480188,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="GjVM2yPbEj7P" data-outputId="5fb10f4f-722a-4f3a-b7e7-5733a9fde2c5">
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score, classification_report</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted the tuned Random Forest model with best hyperparameters</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: <span class="va">None</span>, <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">150</span>}</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>rf_model_tuned <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>, <span class="op">**</span>best_params)</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>rf_model_tuned.fit(X_train_smote, y_train_smote)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train_imputed back to DF with original column names</span></span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>X_train_imputed_df <span class="op">=</span> pd.DataFrame(X_train_imputed, columns<span class="op">=</span>X.columns)</span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialized Feature Importance</span></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>feature_importances <span class="op">=</span> rf_model_tuned.feature_importances_</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Created DF to store feature names and their corresponding importances</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;Feature&#39;</span>: X_train_imputed_df.columns, <span class="st">&#39;Importance&#39;</span>: feature_importances})</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Sorted DF by importance in descending order</span></span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>feature_importance_df <span class="op">=</span> feature_importance_df.sort_values(by<span class="op">=</span><span class="st">&#39;Importance&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotted the feature importances</span></span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&#39;Importance&#39;</span>, y<span class="op">=</span><span class="st">&#39;Feature&#39;</span>, data<span class="op">=</span>feature_importance_df, palette<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Random Forest Feature Importances with SMOTE&#39;</span>)</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Importance&#39;</span>)</span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Feature&#39;</span>)</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Feature importance Results</span></span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Feature Importances:&quot;</span>)</span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(feature_importance_df)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a></span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/91a9960f9b87c2808681d21c30e31f6e59836bb3.png" /></p>
</div>
<div class="output stream stdout">
<pre><code>Feature Importances:
           Feature  Importance
9          DEBTINC    0.149091
7             NINQ    0.132911
6            CLAGE    0.094140
12       JOB_Other    0.090872
2            VALUE    0.081441
0             LOAN    0.080882
1          MORTDUE    0.072688
8             CLNO    0.068364
3              YOJ    0.061232
13     JOB_ProfExe    0.049967
11      JOB_Office    0.044729
10  REASON_HomeImp    0.044132
15        JOB_Self    0.010374
16     JOB_Unknown    0.009852
14       JOB_Sales    0.009325
5           DELINQ    0.000000
4            DEROG    0.000000
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="102"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4205,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661484391,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="BLE3bisoRoPw" data-outputId="d466f103-0f87-4e9e-e905-e744f5137e15">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># In addition to Feature importance, I conducted a SHAP Analysis</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install shap</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: shap in /usr/local/lib/python3.10/dist-packages (0.44.0)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from shap) (1.23.5)
Requirement already satisfied: scipy in /usr/local/lib/python3.10/dist-packages (from shap) (1.11.4)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.10/dist-packages (from shap) (1.2.2)
Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from shap) (1.5.3)
Requirement already satisfied: tqdm&gt;=4.27.0 in /usr/local/lib/python3.10/dist-packages (from shap) (4.66.1)
Requirement already satisfied: packaging&gt;20.9 in /usr/local/lib/python3.10/dist-packages (from shap) (23.2)
Requirement already satisfied: slicer==0.0.7 in /usr/local/lib/python3.10/dist-packages (from shap) (0.0.7)
Requirement already satisfied: numba in /usr/local/lib/python3.10/dist-packages (from shap) (0.58.1)
Requirement already satisfied: cloudpickle in /usr/local/lib/python3.10/dist-packages (from shap) (2.2.1)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba-&gt;shap) (0.41.1)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;shap) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas-&gt;shap) (2023.3.post1)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn-&gt;shap) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn-&gt;shap) (3.2.0)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.8.1-&gt;pandas-&gt;shap) (1.16.0)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="103"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:796}"
data-executionInfo="{&quot;elapsed&quot;:4509,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661488895,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="TM4fWiUiV23L" data-outputId="a90ef3b4-749c-4cba-d357-4396fb938022">
<div class="sourceCode" id="cb78"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> imblearn.over_sampling <span class="im">import</span> SMOTE</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>target_column <span class="op">=</span> <span class="st">&#39;BAD&#39;</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Handled Categorical Variables</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>categorical_columns <span class="op">=</span> [<span class="st">&#39;REASON&#39;</span>, <span class="st">&#39;JOB&#39;</span>]</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>data_encoded <span class="op">=</span> pd.get_dummies(data, columns<span class="op">=</span>categorical_columns, drop_first<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the Data</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> data_encoded.drop(target_column, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> data_encoded[target_column]</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Converted X_train to a DataFrame</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>X_train_df <span class="op">=</span> pd.DataFrame(X_train, columns<span class="op">=</span>X_train.columns)</span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Used KNNImputer again with a value of 5 for imputing missing values</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>imputer <span class="op">=</span> KNNImputer(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>X_train_imputed <span class="op">=</span> imputer.fit_transform(X_train_df)</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>X_test_imputed <span class="op">=</span> imputer.transform(X_test)</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Applied SMOTE oversampling to the training set</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>smote <span class="op">=</span> SMOTE(random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>X_train_smote, y_train_smote <span class="op">=</span> smote.fit_resample(X_train_imputed, y_train)</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted the tuned Random Forest model with best hyperparameters</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>best_params <span class="op">=</span> {<span class="st">&#39;max_depth&#39;</span>: <span class="va">None</span>, <span class="st">&#39;min_samples_leaf&#39;</span>: <span class="dv">1</span>, <span class="st">&#39;min_samples_split&#39;</span>: <span class="dv">2</span>, <span class="st">&#39;n_estimators&#39;</span>: <span class="dv">150</span>}</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>rf_model_tuned <span class="op">=</span> RandomForestClassifier(random_state<span class="op">=</span><span class="dv">42</span>, <span class="op">**</span>best_params)</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>rf_model_tuned.fit(X_train_smote, y_train_smote)</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a><span class="co"># SHAP Explainer Created, Initialization of SHAP</span></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(rf_model_tuned)</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Set Up X_test_instance</span></span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a>X_test_instance <span class="op">=</span> pd.DataFrame(X_test_imputed[<span class="dv">0</span>].reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), columns<span class="op">=</span>X_train_df.columns)</span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculated SHAP values</span></span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X_test_instance)</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshaped SHAP values</span></span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>shap_values_2d <span class="op">=</span> np.array(shap_values).reshape(<span class="bu">len</span>(shap_values), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed SHAP values</span></span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;SHAP Values for the first instance:&quot;</span>)</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(shap_values_2d[<span class="dv">0</span>])</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed the original feature values for the test instance</span></span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Original Feature Values:&quot;</span>)</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X_test_instance)</span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed the expected value from the explainer</span></span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Expected Value:&quot;</span>)</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(explainer.expected_value[<span class="dv">0</span>])</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed the output of the model for the test instance</span></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Model Output for the Test Instance:&quot;</span>)</span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(explainer.expected_value[<span class="dv">0</span>] <span class="op">+</span> np.<span class="bu">sum</span>(shap_values_2d[<span class="dv">0</span>]))</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed the force plot details</span></span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Force Plot Details:&quot;</span>)</span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a>shap.force_plot(explainer.expected_value[<span class="dv">0</span>], shap_values_2d[<span class="dv">0</span>], X_test_instance, feature_names<span class="op">=</span>X_train_df.columns)</span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Printed the matplotlib figure</span></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Matplotlib Figure:&quot;</span>)</span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>shap.force_plot(explainer.expected_value[<span class="dv">0</span>], shap_values_2d[<span class="dv">0</span>], X_test_instance, feature_names<span class="op">=</span>X_train_df.columns, matplotlib<span class="op">=</span><span class="va">True</span>, show<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>SHAP Values for the first instance:
[ 0.0078526   0.0155801  -0.00864561  0.02004765  0.          0.
 -0.01074362  0.10106742  0.01385149  0.06386203  0.01390751  0.11784893
  0.07745214  0.01778485  0.00466998  0.00562076  0.00017936]

Original Feature Values:
      LOAN  MORTDUE    VALUE  YOJ  DEROG  DELINQ       CLAGE  NINQ  CLNO  \
0  10600.0  44696.0  57686.0  0.0    0.0     0.0  170.340974   0.0  20.0   

     DEBTINC  REASON_HomeImp  JOB_Office  JOB_Other  JOB_ProfExe  JOB_Sales  \
0  37.792555             0.0         1.0        0.0          0.0        0.0   

   JOB_Self  JOB_Unknown  
0       0.0          0.0  

Expected Value:
0.49966441207076007

Model Output for the Test Instance:
0.9399999999999985

Force Plot Details:

Matplotlib Figure:
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_cd8b0c4ebfeb42e1a16c493db1ef198b/64d9bb74d760f03c268051a1808fdb277f8a3cf1.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="103"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1702661488896,&quot;user&quot;:{&quot;displayName&quot;:&quot;Vulcan Encryptor&quot;,&quot;userId&quot;:&quot;14745082030580671116&quot;},&quot;user_tz&quot;:480}"
id="C8_dvUV8fsLj">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
<section id="summary" class="cell markdown" id="bbtBboOShFDa">
<h1>Summary:</h1>
<ol>
<li><p><strong>Comparison of various techniques and their relative
performance based on the chosen Metric (Measure of
success):</strong></p>
<ul>
<li><p><strong>Logistic Regression:</strong> Logistic regression, with
KNN imputation of k=5 demonstrated an accuracy of 0.79. While achieving
a relatively decent accuracy, this technique faced challenges in
correctly identifying instances of loan default ('1') with a recall of
.13 which was abysmal. The precision for the majority class ('0') was
commendable, indicating a good ability to correctly classify non-default
instances. However, the recall and precision for the minority class
('1') were comparatively low. From here, SMOTE oversampling was
implemented to increase accuracy and recall for the model and subsequent
models due to the disbalanced nature of the dataset. With smote,
accuracy decreased to .64 however the recall for class ('1') increased
to .69 marking a significant improvement in the models ability to deal
with false positives and false negatives for the defaulter class.
However, since overall accuracy scores remained considerably low,
further evaluation was required with a different model.</p></li>
<li><p><strong>Decision Tree:</strong> The decision tree model exhibited
improved performance with an accuracy of 0.82, surpassing the logistic
regression. Hyperparameter tuning through grid search slightly decreased
its performance. The decision tree still fell short of achieving the
accuracy levels attained by the tuned random forest. The precision and
recall for the minority class showed improvement at 0.59 and 0.58 but
did not match the balanced performance achieved by the random forest.
Overall scores were mediocre.The decision tree serves as an intermediary
step, showcasing that fine-tuning can enhance model performance.
Nevertheless, it is evident that more sophisticated ensemble methods are
required to achieve optimal results.</p></li>
<li><p><strong>Tuned Random Forest:</strong> The tuned random forest
emerged as the top-performing technique, boasting an accuracy of 0.88.
Precision and Recall for the ('1') class improved to 0.83 and 0.63. This
result indicates a substantial improvement over both the logistic
regression and the decision tree. The random forest exhibited a better
balance between precision and recall for both classes ('0' and '1').
This is crucial in the context of predicting loan defaulters, where both
false positives and false negatives can have significant consequences.
The success of the random forest can be attributed to its ensemble
nature, aggregating predictions from multiple decision trees and
mitigating overfitting.The success of the random forest highlights its
robustness in handling the complexities of loan default prediction,
making it a reliable choice for banks seeking accurate and balanced risk
assessments</p></li>
</ul></li>
<li><p><strong>Refined insights:</strong></p>
<p>A. <strong>Model Performance</strong></p>
<p>This data set presented several challenges. Due to missing data, an
imbalance in the target class, and categorical values, we implemented
several techniques to deal with these obstacles.</p>
<p>We implemented KNN to ensure an accurate representation of missing
values in the dataset being referenced by proximity of similar values
instead of a gross mean, we also used SMOTE to reduce the imbalance in
the test data as scores and accuracy markley improved in the logistic
regression and all further models due to the ability to sample evenly
across the data set.</p>
<p>We also handled categorical variables appropriately, ensuring that
there was no disruption in model testing or analysis with variables to
ensure that we obtained meaningful insights from these columns instead
of dropping them.</p>
<p>While there was a marked improvement in accuracy, recall, f-1, and
precision for the decision tree, the Tuned Random Forest emerged as the
unequivocal leader, consistently outperforming other models. Its
superiority was evident in achieving the highest scores across the
board. This robust performance is crucial in the context of predicting
loan defaulters, where precision and recall are equally important. The
balanced performance of the tuned random forest underscores its
reliability in identifying both positive and negative instances,
ensuring a comprehensive understanding of potential loan default
risks.</p>
<p>B. <strong>Key Features</strong></p></li>
</ol>
<p><strong>DEBTINC</strong> (Debt-to-Income Ratio): With the highest
importance score, DEBTINC remains the most critical variable. The
debt-to-income ratio is a key indicator of a borrower's ability to repay
a loan. Lenders should focus on assessing and potentially limiting loans
for individuals with high DEBTINC to manage default risks
effectively.</p>
<p><strong>NINQ</strong> (Number of Recent Inquiries): NINQ emerges as
the second most important feature. Monitoring the number of recent
credit inquiries can provide insights into a borrower's credit behavior.
Higher NINQ values may indicate increased financial stress, higher
ammounts of debt with different lines of credit, warranting closer
scrutiny during the lending process.</p>
<p><strong>CLAGE</strong> (Oldest Line of Credit): The age of the oldest
line of credit remains a crucial determinant of default risk.
Individuals with a longer credit history, as indicated by higher CLAGE
values, tend to pose lower default risks. Lenders should consider this
factor when assessing an applicant's creditworthiness.</p>
<p><strong>JOB</strong> (Employment Status): Specific job categories,
such as "Other," "ProfExe," "Office," "Self," and "Sales," contribute to
risk assessment. Lenders should carefully evaluate the employment status
of applicants, giving additional attention to those in certain job
categories.</p>
<p><strong>VALUE</strong> (Property Value) and LOAN (Loan Amount):
Property value (VALUE) and loan amount (LOAN) continue to be fundamental
factors influencing default risk. Lenders may consider implementing
policies that cap loan amounts based on property values to manage risk
effectively.</p>
<p><strong>MORTDUE</strong> (Mortgage Amount Due), CLNO (Number of
Credit Lines), and YOJ (Years at Current Job): These variables, while
important, have slightly lower importance scores. Nevertheless, lenders
should still consider them in the risk assessment process, particularly
when combined with other critical factors.</p>
<p><strong>REASON</strong> (Loan Purpose): The purpose of the loan,
especially for home improvement (REASON_HomeImp), plays a role in risk
evaluation. Lenders should be attentive to the loan's intended use and
its potential correlation with default risk.</p>
<p>Recommendations: Lenders can use these insights to develop risk
mitigation strategies. This may include scrutinizing applicants with
high DEBTINC and NINQ values, considering the applicant's job category,
and implementing policies based on property values to enhance risk
management.</p>
<p>C. <strong>Interpretation of SHAP Values:</strong></p>
<p>SHAP values provided a granular understanding of how each feature
contributes to model predictions. Positive SHAP values for certain
features indicate an increased likelihood of loan default, while
negative values suggest a reduced likelihood. Interpretation of SHAP
values for the specific instance in focus allows for a detailed
examination of the factors influencing the model's prediction. This
transparency enhances the model's interpretability and aids in making
informed lending decisions.</p>
<ol>
<li><p><strong>Proposal for the final solution design:</strong></p>
<p>A. <strong>Logistic Regression:</strong></p>
<p>The Logistic Regression model exhibited a mediocre accuracy 0f 0.64,
however its recall imporvement after smote for class 0 was notable
however, the tradeoff between precision and accuracy plagued this model.
This limitation made it clear that a more pobust model was needed to
handle the challenge of accuratley predicting defaults without the risk
of false positives.</p>
<p>B. <strong>Decision Tree:</strong></p>
<p>The Decision Tree, especially after the hyperparameter tuning,
offered decent accuracy and recall. The balanced simplicity and
performance were evident in similar scores for the untuned (0.82) and
tuned (0.81) versions. However, the decrease in accuracy with tuning
raised concerns about the model's ability to further improve
performance. While the Decision Tree provides a good compromise between
interpretability and performance, the pursuit of higher accuracy led to
exploring more sophisticated model.</p>
<p>C. <strong>Tuned Random Forest:</strong></p>
<p>The Tuned Random Forest emerged as the top-performing model,
showcasing the highest accuracy and recall for class 0. The improved
precision score for class 1 from 0.87 (untuned) to 0.88 (tuned)
indicates that the model had already reached a high level of
optimization. The recall for class 1 markedly improved as well to 0.63.
Precision, Recall, and F-1 remained in the 90's for class 0 but since we
are aiming at predicting loan default the true improvement lay in the
precision of 0.83, recall of 0.63, and f-1 of 0.72 for the defaulter
class. Since we want to predcit default to mitigate borrowers risk,
precision and recall in this field are imperative for the sucess of the
model. The improveents from linear regression to this were satisfactory.
Feature importance showed us that DEBTINC, NINQ, CLAGE, and job_Other
were all variables of importance to observe when attempting to predict
if a borrower would default on a loan. The SHAP analysis further
solidified the model's credibility, aligning closely with the feature
importance scores. DEBTINC, CLAGE, LOAN, and VALUE were consistently
identified as the most important features, and the positive SHAP values
emphasized their significance in accurate predictions. The convergence
of feature importance and SHAP results strengthens the overall
credibility and effectiveness of the Tuned Random Forest model in
capturing underlying patterns within this dataset.</p>
<ol>
<li><strong>Model Deployability:</strong></li>
</ol>
<p>The deployability of the tuned Random Forest model is a crucial
consideration in translating the analysis into real-world applications.
The model's exceptional performance, as evidenced by its high accuracy,
balanced recall for both classes, and robust interpretability through
SHAP analysis, positions it as a strong candidate for deployment in
production.</p>
<p>However, deploying a machine learning model involves more than just
its performance on historical data. Several factors need to be taken
into account, such as:</p>
<ul>
<li><p><strong>Scalability:</strong> Assess the model's scalability to
handle predictions for a larger volume of data in a production
environment.</p></li>
<li><p><strong>Real-time Inference:</strong> Evaluate the model's
efficiency in providing real-time predictions, especially if timely
decisions are critical.</p></li>
<li><p><strong>Data Drift:</strong> Monitor and account for potential
changes in the distribution of incoming data, as models are trained on
historical data and may be sensitive to shifts.</p></li>
<li><p><strong>Ethical Considerations:</strong> Ensure that the
deployment adheres to ethical standards, addressing any biases and
ensuring fairness, particularly in the context of lending
decisions.</p></li>
<li><p><strong>Integration:</strong> Plan for the integration of the
model into existing systems and workflows, considering compatibility and
ease of implementation.</p></li>
</ul>
<p>Before deploying the tuned Random Forest model, it is advisable to
conduct thorough testing in a controlled environment to assess its
performance under production conditions. Additionally, continuous
monitoring and periodic re-evaluation are essential to maintain the
model's effectiveness over time.</p>
<p>In conclusion, while the tuned Random Forest model exhibits strong
potential for deployment based on its performance and interpretability,
careful consideration of deployment-related factors is necessary to
ensure its seamless integration into real-world applications.</p>
<ol>
<li><strong>Business Considerations</strong></li>
</ol>
<p>Below are two separate profiles that highlight the predictions of the
random forest model and are helpful in aiding financial institutions in
discerning proper candidates for a loan.</p></li>
</ol>
<p><strong>Profile: Potential Loan Defaulter</strong></p>
<ul>
<li><p>High Debt-to-Income Ratio (DEBTINC):</p></li>
<li><p>Characteristic: Individuals with a significant proportion of
their income dedicated to debt payments. Risk Indicator: High DEBTINC
increases the likelihood of struggling with repayments, making them
prone to default.</p></li>
</ul>
<p>-High number of credit inquries (NINQ)</p>
<ul>
<li>Characteristic: Individuals with a large number of credit inquries
could be at risk of defaulting. The inquiry count could be correlated
with multiple lines of overleveraged credit, financial duress and/or
stress.</li>
</ul>
<p>Limited Credit History (CLAGE):</p>
<ul>
<li><p>Characteristic: Short duration of the oldest line of credit. Risk
Indicator: Limited credit history suggests less experience managing
credit, potentially impacting the ability to meet loan obligations.
Large Loan Amount (LOAN):</p></li>
<li><p>Characteristic: Applicants seeking substantial loan amounts. Risk
Indicator: Higher loan amounts may indicate a higher financial burden,
elevating the risk of default if the borrower faces financial
challenges. Lower Property Value (VALUE):</p></li>
<li><p>Characteristic: Collateral with a lower appraised value. Risk
Indicator: Lower property value may suggest limited assets, potentially
affecting the ability to recover the loan amount in case of
default.</p></li>
</ul>
<p><strong>Profile: Non-Defaulter</strong></p>
<p>Moderate Debt-to-Income Ratio (DEBTINC):</p>
<ul>
<li>Characteristic: Individuals with a balanced ratio of income to debt
payments. Indicator: Moderate DEBTINC indicates a healthier financial
position, reducing the likelihood of repayment challenges.</li>
</ul>
<p>Limited Credit Inquiries (NINQ): -Characteristic: Individuals who
have low credit inquries may have less current debat and may be
postiioned to handle a mortage properly since a low credit inquiry
correlates to a lower ammount of DEBTINC. The borrower is most likely
not under financial duress and may not have anything to inquire about or
open new lines of credit indicating financial stability.</p>
<p>Established Credit History (CLAGE):</p>
<ul>
<li>Characteristic: Longer duration of the oldest line of credit.
Indicator: A well-established credit history reflects experience in
managing credit responsibly, enhancing the ability to meet loan
obligations.</li>
</ul>
<p>Reasonable Loan Amount (LOAN):</p>
<ul>
<li>Characteristic: Applicants seeking loans aligned with their
financial capacity. Indicator: Reasonable loan amounts suggest a mindful
approach to borrowing, reducing the risk of financial strain.</li>
</ul>
<p>Higher Property Value (VALUE):</p>
<ul>
<li><p>Characteristic: Collateral with a higher appraised value.
Indicator: Higher property value provides a stronger financial cushion,
increasing the likelihood of recovering the loan amount in case of
default. Summary:</p></li>
<li><p>Potential Loan Defaulter: Characterized by high DEBTINC, limited
credit history, seeking large loan amounts, and collateral with a lower
appraised value.</p></li>
<li><p>Non-Defaulter: Characterized by moderate DEBTINC, an established
credit history, seeking reasonable loan amounts, and collateral with a
higher appraised value.</p></li>
</ul>
<p><strong>Risk Mitigation Strategies:</strong></p>
<p>Implement caps on loan amounts based on property values. Scrutinize
applicants with high DEBTINC more closely. Evaluate the purpose of the
loan in relation to default risk. Consider credit history and employment
status in lending decisions.</p>
<p><strong>In Summary:</strong></p>
<p>The Tuned Random Forest is recommended as the preferred model due to
its superior accuracy, balanced recall for both classes, and reinforced
credibility through SHAP analysis. Features such as DEBTINC, NINQ,
CLAGE, LOAN, and VALUE play pivotal roles, and the positive SHAP values
validate their importance. This model not only provides accurate
predictions but also offers valuable insights into the factors
influencing loan default, making it the most robust solution for this
predictive analytics problem.</p>
</section>
</body>
</html>
